const express = require('express');
const { ApolloServer, gql } = require('apollo-server-express');


const app = express();

const { schema, resolvers } = require("./attackerSchema");


const server = new ApolloServer({
    typeDefs: schema,
    resolvers,
});


async function startApolloServer() {
    // Wait for the server to start
    await server.start();

    // Apply the middleware to the Apollo Server
    server.applyMiddleware({
        app,
        path: '/graphql',
        // Add the middleware before the Apollo Server middleware
    });
}


const PORT = 3001; // Change this to the desired port number

startApolloServer().then(() => {
    // Start the Express server
    app.listen({ port: PORT }, () => {
        console.log(`Attacker Server started at http://localhost:${PORT}/graphql`);
    });
});
