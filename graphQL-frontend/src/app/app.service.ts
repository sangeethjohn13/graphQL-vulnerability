import { HttpClient } from "@angular/common/http";
import { Injectable } from "@angular/core";
import { Observable } from "rxjs";
import { INTRO_QUERY, AUTH_QUERY, DOS_QUERY } from "./data";

@Injectable({
  providedIn: "root",
})
export class AppService {
  constructor(private _httpClient: HttpClient) {}

  getInjectionAttack(url: string): Observable<any> {
    let urlString = `${url}/graphql?query=${encodeURIComponent(INTRO_QUERY)}`;
    return this._httpClient.get(urlString);
  }

  getIntrospectionAttack(url: string): Observable<any> {
    let urlString = `${url}/graphql?query=${encodeURIComponent(INTRO_QUERY)}`;
    return this._httpClient.get(urlString);
  }

  getAuthAttack(url: string): Observable<any> {
    const graphqlUrl = `${url}/graphql`;
    const headers = { "Content-Type": "application/json" };
    const body = { query: AUTH_QUERY };
    return this._httpClient.post(graphqlUrl, body, { headers });
  }

  getDoSAttack(url: string): Observable<any> {
    let urlString = `${url}/graphql?query=${encodeURIComponent(DOS_QUERY)}`;
    return this._httpClient.get(urlString);
  }
}
